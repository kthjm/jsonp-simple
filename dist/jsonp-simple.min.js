!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.jsonpSimple=n()}(this,function(){"use strict";var e=function e(){var n=Math.floor(1e3*Math.random()),t="jsonp_callback_"+n;return"number"!=typeof n||window[t]?e():t},n=function(e){return{timeout:e.timeout||!1,onerror:e.onerror||!1}},t=function(e){return document.head&&document.head.removeChild(e)},o=function(e){delete window[e]};return function(r){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;if("string"!=typeof r)throw new TypeError('jsonp argument "src" must be "string"');return new Promise(function(c,i){var a=e(),f=function(e){var n=document.createElement("script");return n.src=e,n.async=!0,n}(function(e,n){return e.includes("?")?e+"&callback="+n:e+"?callback="+n}(r,a)),d=function(e){function n(){t(r),o(u)}var r=e.script,u=e.globalName,c=e.resolve,i=e.reject;return{succeed:function(e){c(e),n()},fail:function(e){i(e),n()}}}({resolve:c,reject:i,globalName:a,script:f}),l=d.succeed,m=d.fail,s=setTimeout(function(){return m(n({timeout:!0}))},u);f.onerror=function(e){clearTimeout(s),m(n({onerror:e}))},window[a]=function(e){clearTimeout(s),l(e)},function(e){document.head&&document.head.appendChild(e)}(f)})}});
